# BaseCTF CRYPTO方向two_squares

by zijeff

打开题目发现又是考察的老常客了——RSA加密算法，那我们的常见思路就是求出私钥d，从而解密。

题目也非常贴心地给出了提示，即x的值：
$$
\begin{equation}
x = p^2 + q^2
\end{equation}
$$
所以，如果我们可以根据x的值解出p和q的值，那么这道题就可以被完全解决。

我们又知道sagemath中自带一个命令，就是已知两数平方之和，反过来求解这两个数。

启动sagemath后输入：

```python
x = 209479773119142584969854470862023704936857416491817498021871883305658177375498
two_squares(x)
```

得到结果：

```python
p=312730551067949919826003024531506165487
q=334184642896526518753506901808151350573
```

注：RSA加密中p和q的顺序并不重要，互换顺序不影响加解密，读者自证不难。

解出p和q的值之后就是常规的求解过程了。

（PS：笔者写这道题时被坑了，直接问ai大模型，ai写了个python脚本暴力求解p和q。最后还是上搜索引擎查到sagemath的这条命令，所以笔者也明白了写题不能一味依赖ai大模型，有时还是要自己去查找一些资料的。）